# –ê–ª–ª–æ–∫–∞—Ü–∏—è –ø–∞–º—è—Ç–∏ –≤ Go

## –í–≤–µ–¥–µ–Ω–∏–µ

Go —É–ø—Ä–∞–≤–ª—è–µ—Ç –ø–∞–º—è—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å –ø–æ–º–æ—â—å—é **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–∞–º—è—Ç—å—é (garbage collection, GC)**, –Ω–æ –ø–æ–Ω–∏–º–∞–Ω–∏–µ —Ç–æ–≥–æ, –∫–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∞–ª–ª–æ–∫–∞—Ü–∏—è –ø–∞–º—è—Ç–∏, –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π –∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥.

–í —ç—Ç–æ–π –ª–µ–∫—Ü–∏–∏ –º—ã —Ä–∞–∑–±–µ—Ä–µ–º:
- –°—Ç–µ–∫ –∏ –∫—É—á–∞
- `new` –∏ `make`
- –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—é –∞–ª–ª–æ–∫–∞—Ü–∏–∏
- –ò–∑–±–µ–≥–∞–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏

---

## –°—Ç–µ–∫ –∏ –∫—É—á–∞

–í Go –ø–∞–º—è—Ç—å –∞–ª–ª–æ—Ü–∏—Ä—É–µ—Ç—Å—è –≤ **—Å—Ç–µ–∫–µ (stack)** –∏ **–∫—É—á–µ (heap)**.

### üìå –°—Ç–µ–∫ (Stack)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ –≤—ã–∑–æ–≤–æ–≤ —Ñ—É–Ω–∫—Ü–∏–π
- –ë—ã—Å—Ç—Ä–∞—è –∞–ª–ª–æ–∫–∞—Ü–∏—è –∏ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ
- –†–∞–∑–º–µ—Ä –æ–≥—Ä–∞–Ω–∏—á–µ–Ω
- –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —É–¥–∞–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—Å–ª–µ –≤—ã—Ö–æ–¥–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏

–ü—Ä–∏–º–µ—Ä:
```go
func add(x, y int) int {
    z := x + y // 'z' —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ —Å—Ç–µ–∫–µ
    return z
}
```

### üìå –ö—É—á–∞ (Heap)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º –≤—Ä–µ–º–µ–Ω–µ–º –∂–∏–∑–Ω–∏
- –ë–æ–ª–µ–µ –º–µ–¥–ª–µ–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø, —Ç–∞–∫ –∫–∞–∫ —Ç—Ä–µ–±—É–µ—Ç—Å—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç—å—é
- –ù–µ —É–¥–∞–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è GC

–ü—Ä–∏–º–µ—Ä:
```go
func createSlice() *[]int {
    s := make([]int, 5) // 's' —Å–æ–∑–¥–∞–µ—Ç—Å—è –≤ –∫—É—á–µ
    return &s
}
```

---

## `new` –∏ `make`

Go –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–≤–∞ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–ª—è –≤—ã–¥–µ–ª–µ–Ω–∏—è –ø–∞–º—è—Ç–∏: `new` –∏ `make`.

### `new`
- –í—ã–¥–µ–ª—è–µ—Ç **–Ω—É–ª–µ–≤—É—é –ø–∞–º—è—Ç—å** –≤ –∫—É—á–µ –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç **—É–∫–∞–∑–∞—Ç–µ–ª—å**
- –ù–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö, —Ç–æ–ª—å–∫–æ –æ–±–Ω—É–ª—è–µ—Ç

–ü—Ä–∏–º–µ—Ä:
```go
p := new(int)  // *int, –∑–Ω–∞—á–µ–Ω–∏–µ = 0
fmt.Println(*p) // 0
```

### `make`
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è **—Ç–æ–ª—å–∫–æ** –¥–ª—è —Å—Ä–µ–∑–æ–≤, –∫–∞—Ä—Ç –∏ –∫–∞–Ω–∞–ª–æ–≤
- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
- –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç **–∑–Ω–∞—á–µ–Ω–∏–µ, –∞ –Ω–µ —É–∫–∞–∑–∞—Ç–µ–ª—å**

–ü—Ä–∏–º–µ—Ä:
```go
s := make([]int, 5)   // –°–æ–∑–¥–∞–µ—Ç —Å—Ä–µ–∑ –¥–ª–∏–Ω–æ–π 5
m := make(map[string]int) // –°–æ–∑–¥–∞–µ—Ç –∫–∞—Ä—Ç—É
c := make(chan int)  // –°–æ–∑–¥–∞–µ—Ç –∫–∞–Ω–∞–ª
```

üîπ **–†–∞–∑–Ω–∏—Ü–∞**: `new` –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å, `make` –≤—ã–¥–µ–ª—è–µ—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç.

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∞–ª–ª–æ–∫–∞—Ü–∏–∏

### üîπ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
–ï—Å–ª–∏ –∑–∞—Ä–∞–Ω–µ–µ –∏–∑–≤–µ—Å—Ç–µ–Ω —Ä–∞–∑–º–µ—Ä —Å—Ä–µ–∑–∞, –ª—É—á—à–µ —Å—Ä–∞–∑—É –≤—ã–¥–µ–ª–∏—Ç—å –Ω—É–∂–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤:
```go
s := make([]int, 1000) // –õ—É—á—à–µ, —á–µ–º append –ø—Ä–∏ —Ä–æ—Å—Ç–µ
```

### üîπ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—É–ª–∞ –æ–±—ä–µ–∫—Ç–æ–≤ (`sync.Pool`)
Go –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç `sync.Pool` –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –æ–±—ä–µ–∫—Ç–æ–≤ –∏ —É–º–µ–Ω—å—à–µ–Ω–∏—è –Ω–∞–≥—Ä—É–∑–∫–∏ –Ω–∞ GC:
```go
import "sync"
var pool = sync.Pool{
    New: func() interface{} { return new([]byte) },
}

func main() {
    b := pool.Get().(*[]byte)
    defer pool.Put(b) // –í–æ–∑–≤—Ä–∞—â–∞–µ–º –≤ –ø—É–ª
    *b = make([]byte, 1024)
    fmt.Println(len(*b))
}
```

---

## –ò–∑–±–µ–≥–∞–Ω–∏–µ —É—Ç–µ—á–µ–∫ –ø–∞–º—è—Ç–∏

### 1Ô∏è‚É£ –ù–µ —Ö—Ä–∞–Ω–∏—Ç–µ –Ω–µ–Ω—É–∂–Ω—ã–µ —Å—Å—ã–ª–∫–∏
```go
var global *bigStruct
func leaky() {
    s := &bigStruct{}
    global = s // 's' –Ω–µ –æ—Å–≤–æ–±–æ–¥–∏—Ç—Å—è, –ø–æ–∫–∞ global –∂–∏–≤
}
```
‚úÖ –õ—É—á—à–µ:
```go
func nonLeaky() {
    s := &bigStruct{}
    useStruct(s)
    s = nil // GC —É–¥–∞–ª–∏—Ç s
}
```

### 2Ô∏è‚É£ –û—Å–≤–æ–±–æ–∂–¥–∞–π—Ç–µ –≥–æ—Ä—É—Ç–∏–Ω—ã
–ì–æ—Ä—É—Ç–∏–Ω—ã –º–æ–≥—É—Ç —Å–æ–∑–¥–∞–≤–∞—Ç—å —É—Ç–µ—á–∫–∏, –µ—Å–ª–∏ –Ω–µ –∑–∞–≤–µ—Ä—à–∞—é—Ç—Å—è:
```go
ch := make(chan int)
go func() {
    for v := range ch {
        fmt.Println(v)
    }
}()
```
‚úÖ –ù—É–∂–Ω–æ –∑–∞–∫—Ä—ã–≤–∞—Ç—å –∫–∞–Ω–∞–ª:
```go
close(ch)
```

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

üîπ **–°—Ç–µ–∫** ‚Äî –±—ã—Å—Ç—Ä—ã–π, –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö.
üîπ **–ö—É—á–∞** ‚Äî —É–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è GC, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –¥–æ–ª–≥–æ–∂–∏–≤—É—â–∏—Ö –æ–±—ä–µ–∫—Ç–æ–≤.
üîπ **`new`** –≤—ã–¥–µ–ª—è–µ—Ç –ø–∞–º—è—Ç—å –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç —É–∫–∞–∑–∞—Ç–µ–ª—å.
üîπ **`make`** —Å–æ–∑–¥–∞–µ—Ç –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ä–µ–∑—ã, –∫–∞—Ä—Ç—ã, –∫–∞–Ω–∞–ª—ã.
üîπ **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è**: –∏–∑–±–µ–≥–∞—Ç—å –ª–∏—à–Ω–∏—Ö –∞–ª–ª–æ–∫–∞—Ü–∏–π, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `sync.Pool`, —Å–ª–µ–¥–∏—Ç—å –∑–∞ —É—Ç–µ—á–∫–∞–º–∏.

–ü–æ–Ω–∏–º–∞–Ω–∏–µ —ç—Ç–∏—Ö –º–µ—Ö–∞–Ω–∏–∑–º–æ–≤ –ø–æ–º–æ–≥–∞–µ—Ç –ø–∏—Å–∞—Ç—å –±–æ–ª–µ–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω—ã–π –∫–æ–¥ –≤ Go! üöÄ

