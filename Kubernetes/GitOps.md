# GitOps: –ß—Ç–æ —ç—Ç–æ –∏ –∫–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å GitHub Actions?

## –í–≤–µ–¥–µ–Ω–∏–µ
**GitOps** ‚Äî —ç—Ç–æ –∫–∞–∫ "—É–º–Ω—ã–π –ø–æ–≤–∞—Ä" üç≤, –∫–æ—Ç–æ—Ä—ã–π –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Git (—Ç–≤–æ–π "—Ä–µ—Ü–µ–ø—Ç") –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏ —Å–µ—Ä–≤–µ—Ä–∞–º–∏. –ê **GitHub Actions** ‚Äî —ç—Ç–æ –∫–∞–∫ "–∫—É—Ö–æ–Ω–Ω—ã–π —Ä–æ–±–æ—Ç" ü§ñ, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –≤—Å—ë —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞—Ç—å. –î–∞–≤–∞–π —É–∑–Ω–∞–µ–º, —á—Ç–æ —ç—Ç–æ —Ç–∞–∫–æ–µ –∏ –∫–∞–∫ –∏—Ö –ø–æ–¥—Ä—É–∂–∏—Ç—å! üöÄ

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ GitOps?

**GitOps** ‚Äî —ç—Ç–æ —Å–ø–æ—Å–æ–± —É–ø—Ä–∞–≤–ª—è—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏ –∏ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π (—Å–µ—Ä–≤–µ—Ä–∞–º–∏, –∫–ª–∞—Å—Ç–µ—Ä–∞–º–∏), –∏—Å–ø–æ–ª—å–∑—É—è Git –∫–∞–∫ "–≥–ª–∞–≤–Ω—É—é –∫–Ω–∏–≥—É —Ä–µ—Ü–µ–ø—Ç–æ–≤". –í—Å—ë, —á—Ç–æ –Ω—É–∂–Ω–æ —Ç–≤–æ–µ–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—é ‚Äî –∫–æ–¥, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–µ—Ä–≤–µ—Ä–æ–≤, ‚Äî —Ö—Ä–∞–Ω–∏—Ç—Å—è –≤ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –º–µ–Ω—è–µ—Ç—Å—è, —Ç—ã –æ–±–Ω–æ–≤–ª—è–µ—à—å Git, –∏ —Å–∏—Å—Ç–µ–º–∞ —Å–∞–º–∞ "–≥–æ—Ç–æ–≤–∏—Ç" –≤—Å—ë –ø–æ –Ω–æ–≤–æ–º—É —Ä–µ—Ü–µ–ø—Ç—É.

### –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?
1. –¢—ã –ø–∏—à–µ—à—å "—Ä–µ—Ü–µ–ø—Ç" (–Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ YAML-—Ñ–∞–π–ª–∞—Ö) ‚Äî —á—Ç–æ –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.
2. –≠—Ç–æ—Ç —Ä–µ—Ü–µ–ø—Ç –ª–µ–∂–∏—Ç –≤ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏.
3. –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π "–ø–æ–≤–∞—Ä" (–Ω–∞–ø—Ä–∏–º–µ—Ä, ArgoCD –∏–ª–∏ Flux) —Å–º–æ—Ç—Ä–∏—Ç –Ω–∞ Git –∏ –¥–µ–ª–∞–µ—Ç —Ç–∞–∫, —á—Ç–æ–±—ã —Ä–µ–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–æ–≤–∞–ª —Ä–µ—Ü–µ–ø—Ç—É.
4. –ï—Å–ª–∏ —á—Ç–æ-—Ç–æ –ª–æ–º–∞–µ—Ç—Å—è –∏–ª–∏ –º–µ–Ω—è–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é, "–ø–æ–≤–∞—Ä" –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –≤—Å—ë –∫ —Ç–æ–º—É, —á—Ç–æ –≤ Git.

### –ü—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏
–£ —Ç–µ–±—è –µ—Å—Ç—å —Å–∞–π—Ç –º–∞–≥–∞–∑–∏–Ω–∞ –∏–≥—Ä—É—à–µ–∫. –¢—ã —Ö–æ—á–µ—à—å, —á—Ç–æ–±—ã –æ–Ω —Ä–∞–±–æ—Ç–∞–ª –Ω–∞ —Ç—Ä—ë—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö. –í Git —Ç—ã –ø–∏—à–µ—à—å: "–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–π —Å–∞–π—Ç –≤ —Ç—Ä—ë—Ö –∫–æ–ø–∏—è—Ö". "–ü–æ–≤–∞—Ä" (GitOps-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç) –≤–∏–¥–∏—Ç —ç—Ç–æ –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç —Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞. –ï—Å–ª–∏ –æ–¥–∏–Ω —Å–µ—Ä–≤–µ—Ä "—É–ø–∞–ª", –æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤—ã–π, —á—Ç–æ–±—ã –±—ã–ª–æ —Ä–æ–≤–Ω–æ —Ç—Ä–∏ ‚Äî –∫–∞–∫ –≤ —Ä–µ—Ü–µ–ø—Ç–µ.

---

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω GitOps?

1. **–í—Å—ë –≤ –æ–¥–Ω–æ–º –º–µ—Å—Ç–µ**: –∫–æ–¥ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∂–∏–≤—É—Ç –≤ Git, –∫–∞–∫ –µ–¥–∏–Ω–∞—è "–∫–Ω–∏–≥–∞ –ø—Ä–∞–≤–¥—ã".
2. **–õ–µ–≥–∫–æ —á–∏–Ω–∏—Ç—å**: –µ—Å–ª–∏ —á—Ç–æ-—Ç–æ —Å–ª–æ–º–∞–ª–æ—Å—å, –ø—Ä–æ—Å—Ç–æ —Å–º–æ—Ç—Ä–∏—à—å –≤ Git –∏ –≤–æ–∑–≤—Ä–∞—â–∞–µ—à—å –≤—Å—ë –æ–±—Ä–∞—Ç–Ω–æ.
3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞**: –Ω–∏–∫–∞–∫–∏—Ö —Ä—É—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ ‚Äî –≤—Å—ë —Å–∞–º–æ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è.
4. **–ò—Å—Ç–æ—Ä–∏—è**: Git —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è, –∫–∞–∫ –¥–Ω–µ–≤–Ω–∏–∫.

---

## –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å GitOps —Å GitHub Actions?

**GitHub Actions** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏ –∑–∞–¥–∞—á –ø—Ä—è–º–æ –≤ GitHub. –û–Ω –∏–¥–µ–∞–ª—å–Ω–æ –ø–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è **CI** (Continuous Integration ‚Äî —Å–±–æ—Ä–∫–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞), –∞ —Å GitOps –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∏ **CD** (Continuous Deployment ‚Äî —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ). –í–æ—Ç –∫–∞–∫ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å —à–∞–≥ –∑–∞ —à–∞–≥–æ–º.

### –ü—Ä–æ—Å—Ç–∞—è —Å—Ö–µ–º–∞
1. –ü–∏—à–µ—à—å –∫–æ–¥ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∞–π—Ç).
2. GitHub Actions —Å–æ–±–∏—Ä–∞–µ—Ç –µ–≥–æ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä (Docker-–æ–±—Ä–∞–∑).
3. Actions –æ–±–Ω–æ–≤–ª—è–µ—Ç "—Ä–µ—Ü–µ–ø—Ç" –≤ Git-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –º–µ–Ω—è–µ—Ç –≤–µ—Ä—Å–∏—é –æ–±—Ä–∞–∑–∞).
4. GitOps-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç (–Ω–∞–ø—Ä–∏–º–µ—Ä, ArgoCD) –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–µ—Ä–≤–µ—Ä.

---

### –ü—Ä–∏–º–µ—Ä: –°–∞–π—Ç –º–∞–≥–∞–∑–∏–Ω–∞ –∏–≥—Ä—É—à–µ–∫

–î–∞–≤–∞–π –Ω–∞—Å—Ç—Ä–æ–∏–º GitOps —Å GitHub Actions –¥–ª—è —Å–∞–π—Ç–∞. –£ –Ω–∞—Å –±—É–¥–µ—Ç –¥–≤–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
- **toy-shop-app**: –∫–æ–¥ —Å–∞–π—Ç–∞.
- **toy-shop-infra**: "—Ä–µ—Ü–µ–ø—Ç—ã" –¥–ª—è Kubernetes (–∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞).

#### –®–∞–≥ 1: –ö–æ–¥ —Å–∞–π—Ç–∞ –∏ Dockerfile
–í `toy-shop-app` —É —Ç–µ–±—è –µ—Å—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Å–∞–π—Ç –∏ `Dockerfile`:
```dockerfile
FROM node:18
WORKDIR /app
COPY . .
RUN npm install
CMD ["npm", "start"]
EXPOSE 3000
```

#### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π GitHub Actions
–°–æ–∑–¥–∞–π —Ñ–∞–π–ª `.github/workflows/build.yml` –≤ `toy-shop-app`:
```yaml
name: Build and Deploy
on: 
  push:
    branches: [ main ]  # –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –ø—É—à–µ –≤ main

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4  # –ë–µ—Ä—ë–º –∫–æ–¥
      - name: Build Docker image
        run: docker build -t ghcr.io/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop:${{ github.sha }} .
      - name: Login to GitHub Container Registry
        run: echo "${{ secrets.GITHUB_TOKEN }}" | docker login ghcr.io -u ${{ github.actor }} --password-stdin
      - name: Push Docker image
        run: docker push ghcr.io/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop:${{ github.sha }}
      - name: Update infra repo
        uses: actions/checkout@v4
        with:
          repository: –º–æ–π-–ª–æ–≥–∏–Ω/toy-shop-infra  # –í—Ç–æ—Ä–æ–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
          token: ${{ secrets.INFRA_TOKEN }}  # –¢–æ–∫–µ–Ω –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
          path: infra
      - name: Update image tag
        run: |
          sed -i "s|image: ghcr.io/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop:.*|image: ghcr.io/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop:${{ github.sha }}|" infra/deployment.yaml
          cd infra
          git config user.name "GitHub Actions Bot"
          git config user.email "bot@github.com"
          git add .
          git commit -m "Update to ${{ github.sha }}"
          git push
```

- **–ß—Ç–æ —Ç—É—Ç –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç?**
  - –ü—Ä–∏ –ø—É—à–µ –≤ `main` Actions —Å–æ–±–∏—Ä–∞–µ—Ç Docker-–æ–±—Ä–∞–∑.
  - –û–±—Ä–∞–∑ –ø—É—à–∏—Ç—Å—è –≤ GitHub Container Registry.
  - –ü–æ—Ç–æ–º Actions –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ñ–∞–π–ª `deployment.yaml` –≤–æ –≤—Ç–æ—Ä–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (`toy-shop-infra`) —Å –Ω–æ–≤–æ–π –≤–µ—Ä—Å–∏–µ–π –æ–±—Ä–∞–∑–∞.

*(–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –°–æ–∑–¥–∞–π —Ç–æ–∫–µ–Ω –≤ GitHub -> Settings -> Developer settings -> Personal access tokens, –¥–∞–π –µ–º—É –¥–æ—Å—Ç—É–ø –∫ `repo`, –∏ –¥–æ–±–∞–≤—å –≤ —Å–µ–∫—Ä–µ—Ç—ã –∫–∞–∫ `INFRA_TOKEN`.)*

#### –®–∞–≥ 3: "–†–µ—Ü–µ–ø—Ç" –≤ `toy-shop-infra`
–í `toy-shop-infra` –ª–µ–∂–∏—Ç —Ñ–∞–π–ª `deployment.yaml` –¥–ª—è Kubernetes:
```yaml
apiVersion: apps/v1
kind: Deployment
metadata:
  name: toy-shop
spec:
  replicas: 3  # –¢—Ä–∏ –∫–æ–ø–∏–∏ —Å–∞–π—Ç–∞
  selector:
    matchLabels:
      app: toy-shop
  template:
    metadata:
      labels:
        app: toy-shop
    spec:
      containers:
      - name: toy-shop
        image: ghcr.io/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop:sha  # –¢—É—Ç –º–µ–Ω—è–µ—Ç—Å—è –≤–µ—Ä—Å–∏—è
        ports:
        - containerPort: 3000
```

#### –®–∞–≥ 4: –ü–æ–¥–∫–ª—é—á–∞–µ–º GitOps-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç
–£—Å—Ç–∞–Ω–æ–≤–∏ **ArgoCD** –≤ —Å–≤–æ–π Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä:
1. –î–æ–±–∞–≤—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π `toy-shop-infra` –≤ ArgoCD:
   ```
   argocd repo add https://github.com/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop-infra --username –º–æ–π-–ª–æ–≥–∏–Ω --password —Ç–≤–æ–π-—Ç–æ–∫–µ–Ω
   ```
2. –°–æ–∑–¥–∞–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:
   ```
   argocd app create toy-shop --repo https://github.com/–º–æ–π-–ª–æ–≥–∏–Ω/toy-shop-infra --path . --dest-server https://kubernetes.default.svc --dest-namespace default --sync-policy automated
   ```
3. ArgoCD –±—É–¥–µ—Ç —Å–ª–µ–¥–∏—Ç—å –∑–∞ `toy-shop-infra` –∏ –æ–±–Ω–æ–≤–ª—è—Ç—å –∫–ª–∞—Å—Ç–µ—Ä, –∫–æ–≥–¥–∞ —Ç–∞–º –º–µ–Ω—è–µ—Ç—Å—è `deployment.yaml`.

---

## –ö–∞–∫ —ç—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ?

1. –¢—ã –ø—É—à–∞–µ—à—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ `toy-shop-app`.
2. GitHub Actions —Å–æ–±–∏—Ä–∞–µ—Ç –Ω–æ–≤—ã–π Docker-–æ–±—Ä–∞–∑ –∏ –ø—É—à–∏—Ç –µ–≥–æ.
3. Actions –æ–±–Ω–æ–≤–ª—è–µ—Ç `deployment.yaml` –≤ `toy-shop-infra`.
4. ArgoCD –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ Git –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ç–≤–æ–π Kubernetes-–∫–ª–∞—Å—Ç–µ—Ä.

–í –∏—Ç–æ–≥–µ: –Ω–æ–≤–∞—è –≤–µ—Ä—Å–∏—è —Å–∞–π—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∑–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç! üéâ

---

## –ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ?

- **–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞**: —Ç—ã —Ç–æ–ª—å–∫–æ –ø–∏—à–µ—à—å –∫–æ–¥, –æ—Å—Ç–∞–ª—å–Ω–æ–µ —Å–∞–º–æ.
- **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å**: –≤—Å—ë –≤ Git, –ª–µ–≥–∫–æ –æ—Ç–∫–∞—Ç–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è.
- **–ü—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç—å**: –≤—Å—è –∫–æ–º–∞–Ω–¥–∞ –≤–∏–¥–∏—Ç, —á—Ç–æ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç.

---

## –ò—Ç–æ–≥

**GitOps** ‚Äî —ç—Ç–æ –∫–∞–∫ "–∫—É–ª–∏–Ω–∞—Ä–Ω–∞—è –∫–Ω–∏–≥–∞" –¥–ª—è —Å–µ—Ä–≤–µ—Ä–æ–≤, –≥–¥–µ Git ‚Äî –∏—Å—Ç–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–¥—ã. **GitHub Actions** ‚Äî —ç—Ç–æ "—Ä–æ–±–æ—Ç", –∫–æ—Ç–æ—Ä—ã–π –≥–æ—Ç–æ–≤–∏—Ç –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∏ –æ–±–Ω–æ–≤–ª—è–µ—Ç —Ä–µ—Ü–µ–ø—Ç—ã. –í–º–µ—Å—Ç–µ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç —Ç–≤–æ—é –∂–∏–∑–Ω—å –ø—Ä–æ—â–µ:
- –ü–∏—à–µ—à—å –∫–æ–¥ ‚Üí Actions —Å–æ–±–∏—Ä–∞–µ—Ç ‚Üí GitOps —Ä–∞–∑–≤–æ—Ä–∞—á–∏–≤–∞–µ—Ç.
