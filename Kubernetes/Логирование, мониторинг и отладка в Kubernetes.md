# Логирование, мониторинг и отладка в Kubernetes

Когда у тебя есть приложение в Kubernetes, ты хочешь знать, что с ним происходит: работает ли оно нормально, нет ли ошибок, и что делать, если что-то сломалось. Для этого нужны три вещи:

- **Мониторинг** — следить за состоянием (например, сколько ресурсов тратит приложение).
- **Логирование** — собирать "дневники" работы приложения (что оно делает и где ошибка).
- **Отладка** — инструменты, чтобы "залезть" внутрь и починить проблему.

## Prometheus + Grafana
### Что это такое?
Prometheus и Grafana — это пара лучших друзей для слежки за твоими приложениями.

- **Prometheus**: это как "шпион", который собирает информацию о том, что происходит в Kubernetes. Например, сколько процессора занято, сколько памяти используется, или сколько запросов приходит к сайту.
- **Grafana**: это как "художник", который превращает данные от Prometheus в красивые графики и dashboards (панели управления), чтобы ты мог всё легко увидеть.

### Как работает?
1. Prometheus ходит по твоему кластеру и записывает метрики (числа, показывающие состояние системы).
2. Grafana берёт эти числа и рисует их в виде линий, столбиков или кругов на экране.

### Пример
У тебя есть сайт. Prometheus следит, сколько людей заходит на него каждую минуту. Grafana показывает это на графике: если линия резко идёт вверх, значит, посетителей стало больше. Если сайт "упал", ты сразу видишь, что что-то не так.

### Зачем нужно?
Чтобы быстро понять, всё ли в порядке с твоим приложением, и заметить проблемы до того, как пользователи начнут жаловаться.

## Loki + Fluentd
### Что это такое?
Loki и Fluentd — это команда для работы с логами (записями о том, что делает приложение).

- **Fluentd**: это как "почтальон", который собирает все "письма" (логи) от твоих контейнеров и отправляет их в одно место.
- **Loki**: это как "библиотека", где все эти письма хранятся и где ты можешь их легко найти и прочитать.

### Как работает?
1. Каждый контейнер в Kubernetes пишет свои логи (например, "Пользователь вошёл", "Ошибка 404").
2. Fluentd собирает эти записи со всех контейнеров.
3. Loki сохраняет их и даёт тебе поиск, чтобы найти нужное (например, все ошибки за последние 5 минут).

### Пример
Твой интернет-магазин работает, но кто-то жалуется, что не может купить товар. Ты открываешь Loki, ищешь слово "ошибка" и видишь: "Нет соединения с базой данных". Теперь ты знаешь, где копать дальше.

### Зачем нужно?
Чтобы видеть, что происходит внутри приложения, и быстро находить причины проблем.

## Debugging tools (инструменты для отладки)
Если что-то сломалось, тебе нужно "залезть" в приложение и понять, что не так. Kubernetes даёт три простых инструмента:

### 1. `kubectl logs`
**Что это?** Команда, которая показывает "дневник" работы контейнера — его логи.

**Как работает?**
```sh
kubectl logs имя-контейнера
```

**Пример**
Твой сайт выдаёт ошибку. Ты запускаешь `kubectl logs web-1` и видишь: "Не могу найти файл config". Значит, проблема в настройках.

### 2. `kubectl exec`
**Что это?** Команда, которая позволяет "зайти" внутрь контейнера и запустить там команды.

**Как работает?**
```sh
kubectl exec -it имя-контейнера -- bash
```

**Пример**
Ты подозреваешь, что в контейнере пропал важный файл. Заходишь через `kubectl exec`, пишешь `ls`, и видишь, что файла действительно нет.

### 3. `kubectl port-forward`
**Что это?** Команда, которая "пробрасывает" порт из контейнера на твой компьютер.

**Как работает?**
```sh
kubectl port-forward имя-контейнера 8080:80
```

**Пример**
Твой веб-сервер работает в контейнере, но ты хочешь проверить, что он выдаёт. Делаешь `port-forward`, открываешь `localhost:8080` и видишь страницу сайта или ошибку.
