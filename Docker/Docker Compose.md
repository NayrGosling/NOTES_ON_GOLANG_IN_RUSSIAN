# Docker Compose

## –í–≤–µ–¥–µ–Ω–∏–µ
**Docker Compose** ‚Äî —ç—Ç–æ –∫–∞–∫ –ø–æ–≤–∞—Ä–µ–Ω–Ω–∞—è –∫–Ω–∏–≥–∞ üìñ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ Docker. –ï—Å–ª–∏ Dockerfile ‚Äî —ç—Ç–æ —Ä–µ—Ü–µ–ø—Ç –¥–ª—è –æ–¥–Ω–æ–π –≤–∫—É—Å–Ω–æ–π –ø–∏—Ü—Ü—ã üçï, —Ç–æ Docker Compose ‚Äî —ç—Ç–æ –º–µ–Ω—é –¥–ª—è —Ü–µ–ª–æ–≥–æ —É–∂–∏–Ω–∞ –∏–∑ –ø–∏—Ü—Ü—ã, —Å–∞–ª–∞—Ç–∞ –∏ –Ω–∞–ø–∏—Ç–∫–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≥–æ—Ç–æ–≤—è—Ç—Å—è –≤–º–µ—Å—Ç–µ! üöÄ

---

## –ß—Ç–æ —Ç–∞–∫–æ–µ Docker Compose?

**Docker Compose** ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π –ø–æ–º–æ–≥–∞–µ—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å —Å—Ä–∞–∑—É –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –∏ —Å–≤—è–∑—ã–≤–∞—Ç—å –∏—Ö –º–µ–∂–¥—É —Å–æ–±–æ–π. –ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —É —Ç–µ–±—è –µ—Å—Ç—å —Å–∞–π—Ç, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –∏ –∫–∞–∫–æ–π-–Ω–∏–±—É–¥—å –±–æ—Ç ‚Äî –≤—Å–µ –æ–Ω–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞—Ö. Docker Compose –≥–æ–≤–æ—Ä–∏—Ç: "–ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å—ë —Ä–∞–∑–æ–º –∏ —Å–æ–µ–¥–∏–Ω—è–µ–º –∏—Ö –ø—Ä–∞–≤–∏–ª—å–Ω–æ!"

- –≠—Ç–æ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª —Å –∏–º–µ–Ω–µ–º `docker-compose.yml`.
- –í –Ω—ë–º —Ç—ã –ø–∏—à–µ—à—å, –∫–∞–∫–∏–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –Ω—É–∂–Ω—ã, –∫–∞–∫ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∏ –∫–∞–∫ –æ–Ω–∏ –±—É–¥—É—Ç "–æ–±—â–∞—Ç—å—Å—è".

---

## –ó–∞—á–µ–º –Ω—É–∂–µ–Ω Docker Compose?

–ï—Å–ª–∏ —Ç—ã –∑–∞–ø—É—Å–∫–∞–µ—à—å –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —á–µ—Ä–µ–∑ `docker run`, —ç—Ç–æ –∫–∞–∫ –ø—Ä–∏–≥–æ—Ç–æ–≤–∏—Ç—å –æ–¥–Ω—É –ø–∏—Ü—Ü—É. –ù–æ –µ—Å–ª–∏ —É —Ç–µ–±—è —Ü–µ–ª—ã–π —Ä–µ—Å—Ç–æ—Ä–∞–Ω (—Å–∞–π—Ç, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, –∫—ç—à), —Ç–æ –≤—Ä—É—á–Ω—É—é –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä ‚Äî —ç—Ç–æ –¥–æ–ª–≥–æ –∏ —Å–ª–æ–∂–Ω–æ. Docker Compose –¥–µ–ª–∞–µ—Ç —ç—Ç–æ –∑–∞ –æ–¥–∏–Ω —à–∞–≥! üéâ

---

## –ö–∞–∫ –≤—ã–≥–ª—è–¥–∏—Ç –ø—Ä–æ—Å—Ç–æ–π `docker-compose.yml`?

–î–∞–≤–∞–π –ø—Ä–∏–≥–æ—Ç–æ–≤–∏–º "—É–∂–∏–Ω" –∏–∑ –¥–≤—É—Ö –±–ª—é–¥: –≤–µ–±-—Å–µ—Ä–≤–µ—Ä–∞ –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö. –í–æ—Ç –ø—Ä–∏–º–µ—Ä –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –Ω–∞ Go –∏ –±–∞–∑—ã PostgreSQL:

```yaml
version: "3"  # –í–µ—Ä—Å–∏—è Docker Compose

services:  # –≠—Ç–æ –∫–∞–∫ —Å–ø–∏—Å–æ–∫ –±–ª—é–¥
  web:  # –ü–µ—Ä–≤–æ–µ –±–ª—é–¥–æ ‚Äî –≤–µ–±-—Å–µ—Ä–≤–µ—Ä
    build: .  # –ì–æ—Ç–æ–≤–∏–º –ø–æ —Ä–µ—Ü–µ–ø—Ç—É –∏–∑ Dockerfile –≤ —Ç–µ–∫—É—â–µ–π –ø–∞–ø–∫–µ
    ports:
      - "8080:8080"  # –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ—Ä—Ç: —Å–Ω–∞—Ä—É–∂–∏ 8080 -> –≤–Ω—É—Ç—Ä–∏ 8080
    depends_on:
      - db  # –ñ–¥—ë–º, –ø–æ–∫–∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –±—É–¥–µ—Ç –≥–æ—Ç–æ–≤–∞

  db:  # –í—Ç–æ—Ä–æ–µ –±–ª—é–¥–æ ‚Äî –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
    image: postgres:15  # –ë–µ—Ä—ë–º –≥–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑ PostgreSQL
    environment:  # –î–æ–±–∞–≤–ª—è–µ–º "—Å–ø–µ—Ü–∏–∏" ‚Äî –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
      - POSTGRES_USER=myuser
      - POSTGRES_PASSWORD=mypass
      - POSTGRES_DB=mydb
    volumes:  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –¥–∞–Ω–Ω—ã–µ –≤ "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫–µ"
      - db-data:/var/lib/postgresql/data

volumes:  # –ù–∞—à "—Ö–æ–ª–æ–¥–∏–ª—å–Ω–∏–∫" –¥–ª—è –¥–∞–Ω–Ω—ã—Ö
  db-data:
```

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

–ü—Ä–µ–¥—Å—Ç–∞–≤—å, —á—Ç–æ —Ç—ã —à–µ—Ñ-–ø–æ–≤–∞—Ä:
1. **web** ‚Äî —ç—Ç–æ —Ç–≤–æ–π –≤–µ–±-—Å–µ—Ä–≤–µ—Ä (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–∞–π—Ç –Ω–∞ Go). –û–Ω –≥–æ—Ç–æ–≤–∏—Ç—Å—è –ø–æ —Ç–≤–æ–µ–º—É —Ä–µ—Ü–µ–ø—Ç—É (Dockerfile) –∏ –ø–æ–¥–∞—ë—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 8080.
2. **db** ‚Äî —ç—Ç–æ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL. –¢—ã –±–µ—Ä—ë—à—å –≥–æ—Ç–æ–≤—ã–π "–ø–æ–ª—É—Ñ–∞–±—Ä–∏–∫–∞—Ç" (`postgres:15`) –∏ –¥–æ–±–∞–≤–ª—è–µ—à—å —Å–≤–æ–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (–∏–º—è, –ø–∞—Ä–æ–ª—å).
3. **depends_on** ‚Äî —ç—Ç–æ –∫–∞–∫ —Å–∫–∞–∑–∞—Ç—å: "–ù–µ –ø–æ–¥–∞–≤–∞–π –ø–∏—Ü—Ü—É, –ø–æ–∫–∞ —Å–∞–ª–∞—Ç –Ω–µ –≥–æ—Ç–æ–≤!"

–ó–∞–ø—É—Å–∫–∞–µ—à—å –≤—Å—ë –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:
```
docker-compose up
```
–ò –≤—É–∞–ª—è ‚Äî —Ç–≤–æ–π "—É–∂–∏–Ω" –≥–æ—Ç–æ–≤! üçΩÔ∏è

---

## –û—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã `docker-compose.yml`

–í–æ—Ç —á—Ç–æ –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≤ —ç—Ç–æ—Ç "—Ä–µ—Ü–µ–ø—Ç":

| –ü–æ–ª–µ          | –ß—Ç–æ –¥–µ–ª–∞–µ—Ç?                                      |
|---------------|-------------------------------------------------|
| `services`    | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö "–±–ª—é–¥" (–∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤).              |
| `build`       | –ì–¥–µ –≤–∑—è—Ç—å —Ä–µ—Ü–µ–ø—Ç (–ø—É—Ç—å –∫ Dockerfile).          |
| `image`       | –ì–æ—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑, –µ—Å–ª–∏ –Ω–µ –Ω—É–∂–Ω–æ –≥–æ—Ç–æ–≤–∏—Ç—å —Å–∞–º–æ–º—É.  |
| `ports`       | –ö–∞–∫–∏–µ –ø–æ—Ä—Ç—ã –æ—Ç–∫—Ä—ã—Ç—å (–Ω–∞–ø—Ä–∏–º–µ—Ä, "8080:8080").   |
| `environment` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–æ–¥–µ –ø–∞—Ä–æ–ª–µ–π –∏–ª–∏ –∏–º—ë–Ω.              |
| `volumes`     | –ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—å –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ–±—ã –æ–Ω–∏ –Ω–µ –ø—Ä–æ–ø–∞–ª–∏.      |
| `depends_on`  | –ß—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å –ø–µ—Ä–≤—ã–º, —á—Ç–æ–±—ã –≤—Å—ë —Ä–∞–±–æ—Ç–∞–ª–æ.      |

---

## –ü—Ä–∏–º–µ—Ä –∏–∑ –∂–∏–∑–Ω–∏

–î–æ–ø—É—Å—Ç–∏–º, —Ç—ã –¥–µ–ª–∞–µ—à—å —Å–∞–π—Ç –º–∞–≥–∞–∑–∏–Ω–∞ –∏–≥—Ä—É—à–µ–∫:
- **–í–µ–±-—Å–µ—Ä–≤–µ—Ä**: –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä–∞–Ω–∏—á–∫–∏ —Å –∏–≥—Ä—É—à–∫–∞–º–∏.
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö**: —Ö—Ä–∞–Ω–∏—Ç —Å–ø–∏—Å–æ–∫ –∏–≥—Ä—É—à–µ–∫ –∏ –∑–∞–∫–∞–∑–æ–≤.

–¢—ã –ø–∏—à–µ—à—å `docker-compose.yml` (–∫–∞–∫ –≤—ã—à–µ), –∑–∞–ø—É—Å–∫–∞–µ—à—å:
```
docker-compose up -d  # -d –∑–Ω–∞—á–∏—Ç "–≤ —Ñ–æ–Ω–µ"
```
–¢–µ–ø–µ—Ä—å —Ç–≤–æ–π —Å–∞–π—Ç —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ `localhost:8080`, –∞ –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≥–æ—Ç–æ–≤–∞ –ø—Ä–∏–Ω–∏–º–∞—Ç—å –∑–∞–∫–∞–∑—ã. –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–∏—Ç—å (`docker-compose down`), –≤—Å—ë —É–±–µ—Ä—ë—Ç—Å—è, –Ω–æ –¥–∞–Ω–Ω—ã–µ –æ—Å—Ç–∞–Ω—É—Ç—Å—è –≤ `volumes`.

---

## –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è: –¥–µ–ª–∞–µ–º "—É–∂–∏–Ω" –ª–µ–≥—á–µ –∏ –≤–∫—É—Å–Ω–µ–µ

1. **–°–µ—Ç–∏ (networks)**  
   –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é Docker Compose —Å–æ–∑–¥–∞—ë—Ç —Å–µ—Ç—å, —á—Ç–æ–±—ã –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã "–æ–±—â–∞–ª–∏—Å—å". –ù–æ —Ç—ã –º–æ–∂–µ—à—å –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å —Å–≤–æ—é:
   ```yaml
   networks:
     my-network:
   ```
   –ò –¥–æ–±–∞–≤–∏—Ç—å –≤ `services`: `networks: - my-network`.

2. **–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ (restart)**  
   –ï—Å–ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä "—É–ø–∞–ª" (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Å–µ—Ä–≤–µ—Ä —Å–ª–æ–º–∞–ª—Å—è), –º–æ–∂–Ω–æ —Å–∫–∞–∑–∞—Ç—å: "–ó–∞–ø—É—Å–∫–∞–π –∑–∞–Ω–æ–≤–æ!"
   ```yaml
   web:
     restart: always
   ```

3. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ —Ä–µ—Å—É—Ä—Å–æ–≤**  
   –ß—Ç–æ–±—ã –æ–¥–∏–Ω –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –Ω–µ —Å—ä–µ–ª –≤—Å–µ "–∏–Ω–≥—Ä–µ–¥–∏–µ–Ω—Ç—ã" (CPU, –ø–∞–º—è—Ç—å):
   ```yaml
   web:
     deploy:
       resources:
         limits:
           cpus: "0.5"  # –ù–µ –±–æ–ª—å—à–µ –ø–æ–ª–æ–≤–∏–Ω—ã –ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–∞
           memory: 512m  # –ù–µ –±–æ–ª—å—à–µ 512 –ú–ë –ø–∞–º—è—Ç–∏
   ```

---

## –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å –∏ —É–ø—Ä–∞–≤–ª—è—Ç—å?

- **–ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å—ë**: `docker-compose up` (–∏–ª–∏ `up -d` –¥–ª—è —Ä–∞–±–æ—Ç—ã –≤ —Ñ–æ–Ω–µ).
- **–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å**: `docker-compose down`.
- **–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏**: `docker-compose logs web` (–ø–æ–∫–∞–∂–µ—Ç, —á—Ç–æ "–≥–æ–≤–æ—Ä–∏—Ç" –≤–µ–±-—Å–µ—Ä–≤–µ—Ä).
- **–ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å**: –ï—Å–ª–∏ –∏–∑–º–µ–Ω–∏–ª Dockerfile, –∏—Å–ø–æ–ª—å–∑—É–π `docker-compose up --build`.

---

## –ü–æ—á–µ–º—É —ç—Ç–æ –∫—Ä—É—Ç–æ?

1. **–ü—Ä–æ—Å—Ç–æ**: –æ–¥–∏–Ω —Ñ–∞–π–ª ‚Äî –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç.
2. **–ë—ã—Å—Ç—Ä–æ**: –Ω–µ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –∫–∞–∂–¥—ã–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –æ—Ç–¥–µ–ª—å–Ω–æ.
3. **–£–¥–æ–±–Ω–æ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**: –º–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å–∞–π—Ç —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö —É —Å–µ–±—è –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ.
4. **–ì–∏–±–∫–æ**: –ª–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å –µ—â—ë –æ–¥–∏–Ω —Å–µ—Ä–≤–∏—Å (–Ω–∞–ø—Ä–∏–º–µ—Ä, –∫—ç—à –∏–ª–∏ –±–æ—Ç).

---

## –ò—Ç–æ–≥

**Docker Compose** ‚Äî —ç—Ç–æ –∫–∞–∫ –º–µ–Ω—é –¥–ª—è —Ç–≤–æ–∏—Ö –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤:
- –ü–∏—à–µ—à—å `docker-compose.yml` ‚Äî —É–∫–∞–∑—ã–≤–∞–µ—à—å, –∫–∞–∫–∏–µ "–±–ª—é–¥–∞" –Ω—É–∂–Ω—ã –∏ –∫–∞–∫ –∏—Ö –≥–æ—Ç–æ–≤–∏—Ç—å.
- –ó–∞–ø—É—Å–∫–∞–µ—à—å –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π ‚Äî –∏ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–º–µ—Å—Ç–µ.
- –î–æ–±–∞–≤–ª—è–µ—à—å "—Å–ø–µ—Ü–∏–∏" (–ø–æ—Ä—Ç—ã, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, volumes) –ø–æ –≤–∫—É—Å—É.

–ï—Å–ª–∏ Dockerfile ‚Äî —ç—Ç–æ —Ä–µ—Ü–µ–ø—Ç –¥–ª—è –æ–¥–Ω–æ–π –ø–∏—Ü—Ü—ã üçï, —Ç–æ Docker Compose ‚Äî —ç—Ç–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è —Ü–µ–ª–æ–≥–æ —É–∂–∏–Ω–∞ —Å –ø–∏—Ü—Ü–µ–π, —Å–∞–ª–∞—Ç–æ–º –∏ —Å–æ–∫–æ–º! üçΩÔ∏è –ü–æ–ø—Ä–æ–±—É–π, –∏ —Ç–≤–æ–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤ Kubernetes –∏–ª–∏ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –º–∞—à–∏–Ω–µ –±—É–¥—É—Ç –≥–æ—Ç–æ–≤—ã –∑–∞ –ø–∞—Ä—É –º–∏–Ω—É—Ç! üöÄ
